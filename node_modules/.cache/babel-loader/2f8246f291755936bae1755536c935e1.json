{"ast":null,"code":"'use strict';\n\nmodule.exports = function footnote_block(state) {\n  var i,\n      l,\n      j,\n      t,\n      lastParagraph,\n      list,\n      tokens,\n      current,\n      currentLabel,\n      level = 0,\n      insideRef = false,\n      refTokens = {};\n\n  if (!state.env.footnotes) {\n    return;\n  }\n\n  state.tokens = state.tokens.filter(function (tok) {\n    if (tok.type === 'footnote_reference_open') {\n      insideRef = true;\n      current = [];\n      currentLabel = tok.label;\n      return false;\n    }\n\n    if (tok.type === 'footnote_reference_close') {\n      insideRef = false; // prepend ':' to avoid conflict with Object.prototype members\n\n      refTokens[':' + currentLabel] = current;\n      return false;\n    }\n\n    if (insideRef) {\n      current.push(tok);\n    }\n\n    return !insideRef;\n  });\n\n  if (!state.env.footnotes.list) {\n    return;\n  }\n\n  list = state.env.footnotes.list;\n  state.tokens.push({\n    type: 'footnote_block_open',\n    level: level++\n  });\n\n  for (i = 0, l = list.length; i < l; i++) {\n    state.tokens.push({\n      type: 'footnote_open',\n      id: i,\n      level: level++\n    });\n\n    if (list[i].tokens) {\n      tokens = [];\n      tokens.push({\n        type: 'paragraph_open',\n        tight: false,\n        level: level++\n      });\n      tokens.push({\n        type: 'inline',\n        content: '',\n        level: level,\n        children: list[i].tokens\n      });\n      tokens.push({\n        type: 'paragraph_close',\n        tight: false,\n        level: --level\n      });\n    } else if (list[i].label) {\n      tokens = refTokens[':' + list[i].label];\n    }\n\n    state.tokens = state.tokens.concat(tokens);\n\n    if (state.tokens[state.tokens.length - 1].type === 'paragraph_close') {\n      lastParagraph = state.tokens.pop();\n    } else {\n      lastParagraph = null;\n    }\n\n    t = list[i].count > 0 ? list[i].count : 1;\n\n    for (j = 0; j < t; j++) {\n      state.tokens.push({\n        type: 'footnote_anchor',\n        id: i,\n        subId: j,\n        level: level\n      });\n    }\n\n    if (lastParagraph) {\n      state.tokens.push(lastParagraph);\n    }\n\n    state.tokens.push({\n      type: 'footnote_close',\n      level: --level\n    });\n  }\n\n  state.tokens.push({\n    type: 'footnote_block_close',\n    level: --level\n  });\n};","map":{"version":3,"names":["module","exports","footnote_block","state","i","l","j","t","lastParagraph","list","tokens","current","currentLabel","level","insideRef","refTokens","env","footnotes","filter","tok","type","label","push","length","id","tight","content","children","concat","pop","count","subId"],"sources":["C:/Users/caoma/Downloads/online-shop/node_modules/remarkable/lib/rules_core/footnote_tail.js"],"sourcesContent":["'use strict';\n\n\nmodule.exports = function footnote_block(state) {\n  var i, l, j, t, lastParagraph, list, tokens, current, currentLabel,\n      level = 0,\n      insideRef = false,\n      refTokens = {};\n\n  if (!state.env.footnotes) { return; }\n\n  state.tokens = state.tokens.filter(function(tok) {\n    if (tok.type === 'footnote_reference_open') {\n      insideRef = true;\n      current = [];\n      currentLabel = tok.label;\n      return false;\n    }\n    if (tok.type === 'footnote_reference_close') {\n      insideRef = false;\n      // prepend ':' to avoid conflict with Object.prototype members\n      refTokens[':' + currentLabel] = current;\n      return false;\n    }\n    if (insideRef) { current.push(tok); }\n    return !insideRef;\n  });\n\n  if (!state.env.footnotes.list) { return; }\n  list = state.env.footnotes.list;\n\n  state.tokens.push({\n    type: 'footnote_block_open',\n    level: level++\n  });\n  for (i = 0, l = list.length; i < l; i++) {\n    state.tokens.push({\n      type: 'footnote_open',\n      id: i,\n      level: level++\n    });\n\n    if (list[i].tokens) {\n      tokens = [];\n      tokens.push({\n        type: 'paragraph_open',\n        tight: false,\n        level: level++\n      });\n      tokens.push({\n        type: 'inline',\n        content: '',\n        level: level,\n        children: list[i].tokens\n      });\n      tokens.push({\n        type: 'paragraph_close',\n        tight: false,\n        level: --level\n      });\n    } else if (list[i].label) {\n      tokens = refTokens[':' + list[i].label];\n    }\n\n    state.tokens = state.tokens.concat(tokens);\n    if (state.tokens[state.tokens.length - 1].type === 'paragraph_close') {\n      lastParagraph = state.tokens.pop();\n    } else {\n      lastParagraph = null;\n    }\n\n    t = list[i].count > 0 ? list[i].count : 1;\n    for (j = 0; j < t; j++) {\n      state.tokens.push({\n        type: 'footnote_anchor',\n        id: i,\n        subId: j,\n        level: level\n      });\n    }\n\n    if (lastParagraph) {\n      state.tokens.push(lastParagraph);\n    }\n\n    state.tokens.push({\n      type: 'footnote_close',\n      level: --level\n    });\n  }\n  state.tokens.push({\n    type: 'footnote_block_close',\n    level: --level\n  });\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}