{"ast":null,"code":"'use strict';\n/**\n * Ruler is a helper class for building responsibility chains from\n * parse rules. It allows:\n *\n *   - easy stack rules chains\n *   - getting main chain and named chains content (as arrays of functions)\n *\n * Helper methods, should not be used directly.\n * @api private\n */\n\nfunction Ruler() {\n  // List of added rules. Each element is:\n  //\n  // { name: XXX,\n  //   enabled: Boolean,\n  //   fn: Function(),\n  //   alt: [ name2, name3 ] }\n  //\n  this.__rules__ = []; // Cached rule chains.\n  //\n  // First level - chain name, '' for default.\n  // Second level - digital anchor for fast filtering by charcodes.\n  //\n\n  this.__cache__ = null;\n}\n/**\n * Find the index of a rule by `name`.\n *\n * @param  {String} `name`\n * @return {Number} Index of the given `name`\n * @api private\n */\n\n\nRuler.prototype.__find__ = function (name) {\n  var len = this.__rules__.length;\n  var i = -1;\n\n  while (len--) {\n    if (this.__rules__[++i].name === name) {\n      return i;\n    }\n  }\n\n  return -1;\n};\n/**\n * Build the rules lookup cache\n *\n * @api private\n */\n\n\nRuler.prototype.__compile__ = function () {\n  var self = this;\n  var chains = ['']; // collect unique names\n\n  self.__rules__.forEach(function (rule) {\n    if (!rule.enabled) {\n      return;\n    }\n\n    rule.alt.forEach(function (altName) {\n      if (chains.indexOf(altName) < 0) {\n        chains.push(altName);\n      }\n    });\n  });\n\n  self.__cache__ = {};\n  chains.forEach(function (chain) {\n    self.__cache__[chain] = [];\n\n    self.__rules__.forEach(function (rule) {\n      if (!rule.enabled) {\n        return;\n      }\n\n      if (chain && rule.alt.indexOf(chain) < 0) {\n        return;\n      }\n\n      self.__cache__[chain].push(rule.fn);\n    });\n  });\n};\n/**\n * Ruler public methods\n * ------------------------------------------------\n */\n\n/**\n * Replace rule function\n *\n * @param  {String} `name` Rule name\n * @param  {Function `fn`\n * @param  {Object} `options`\n * @api private\n */\n\n\nRuler.prototype.at = function (name, fn, options) {\n  var idx = this.__find__(name);\n\n  var opt = options || {};\n\n  if (idx === -1) {\n    throw new Error('Parser rule not found: ' + name);\n  }\n\n  this.__rules__[idx].fn = fn;\n  this.__rules__[idx].alt = opt.alt || [];\n  this.__cache__ = null;\n};\n/**\n * Add a rule to the chain before given the `ruleName`.\n *\n * @param  {String}   `beforeName`\n * @param  {String}   `ruleName`\n * @param  {Function} `fn`\n * @param  {Object}   `options`\n * @api private\n */\n\n\nRuler.prototype.before = function (beforeName, ruleName, fn, options) {\n  var idx = this.__find__(beforeName);\n\n  var opt = options || {};\n\n  if (idx === -1) {\n    throw new Error('Parser rule not found: ' + beforeName);\n  }\n\n  this.__rules__.splice(idx, 0, {\n    name: ruleName,\n    enabled: true,\n    fn: fn,\n    alt: opt.alt || []\n  });\n\n  this.__cache__ = null;\n};\n/**\n * Add a rule to the chain after the given `ruleName`.\n *\n * @param  {String}   `afterName`\n * @param  {String}   `ruleName`\n * @param  {Function} `fn`\n * @param  {Object}   `options`\n * @api private\n */\n\n\nRuler.prototype.after = function (afterName, ruleName, fn, options) {\n  var idx = this.__find__(afterName);\n\n  var opt = options || {};\n\n  if (idx === -1) {\n    throw new Error('Parser rule not found: ' + afterName);\n  }\n\n  this.__rules__.splice(idx + 1, 0, {\n    name: ruleName,\n    enabled: true,\n    fn: fn,\n    alt: opt.alt || []\n  });\n\n  this.__cache__ = null;\n};\n/**\n * Add a rule to the end of chain.\n *\n * @param  {String}   `ruleName`\n * @param  {Function} `fn`\n * @param  {Object}   `options`\n * @return {String}\n */\n\n\nRuler.prototype.push = function (ruleName, fn, options) {\n  var opt = options || {};\n\n  this.__rules__.push({\n    name: ruleName,\n    enabled: true,\n    fn: fn,\n    alt: opt.alt || []\n  });\n\n  this.__cache__ = null;\n};\n/**\n * Enable a rule or list of rules.\n *\n * @param  {String|Array} `list` Name or array of rule names to enable\n * @param  {Boolean} `strict` If `true`, all non listed rules will be disabled.\n * @api private\n */\n\n\nRuler.prototype.enable = function (list, strict) {\n  list = !Array.isArray(list) ? [list] : list; // In strict mode disable all existing rules first\n\n  if (strict) {\n    this.__rules__.forEach(function (rule) {\n      rule.enabled = false;\n    });\n  } // Search by name and enable\n\n\n  list.forEach(function (name) {\n    var idx = this.__find__(name);\n\n    if (idx < 0) {\n      throw new Error('Rules manager: invalid rule name ' + name);\n    }\n\n    this.__rules__[idx].enabled = true;\n  }, this);\n  this.__cache__ = null;\n};\n/**\n * Disable a rule or list of rules.\n *\n * @param  {String|Array} `list` Name or array of rule names to disable\n * @api private\n */\n\n\nRuler.prototype.disable = function (list) {\n  list = !Array.isArray(list) ? [list] : list; // Search by name and disable\n\n  list.forEach(function (name) {\n    var idx = this.__find__(name);\n\n    if (idx < 0) {\n      throw new Error('Rules manager: invalid rule name ' + name);\n    }\n\n    this.__rules__[idx].enabled = false;\n  }, this);\n  this.__cache__ = null;\n};\n/**\n * Get a rules list as an array of functions.\n *\n * @param  {String} `chainName`\n * @return {Object}\n * @api private\n */\n\n\nRuler.prototype.getRules = function (chainName) {\n  if (this.__cache__ === null) {\n    this.__compile__();\n  }\n\n  return this.__cache__[chainName] || [];\n};\n/**\n * Expose `Ruler`\n */\n\n\nmodule.exports = Ruler;","map":{"version":3,"names":["Ruler","__rules__","__cache__","prototype","__find__","name","len","length","i","__compile__","self","chains","forEach","rule","enabled","alt","altName","indexOf","push","chain","fn","at","options","idx","opt","Error","before","beforeName","ruleName","splice","after","afterName","enable","list","strict","Array","isArray","disable","getRules","chainName","module","exports"],"sources":["C:/Users/caoma/Downloads/another/online-shop/node_modules/remarkable/lib/ruler.js"],"sourcesContent":["'use strict';\n\n/**\n * Ruler is a helper class for building responsibility chains from\n * parse rules. It allows:\n *\n *   - easy stack rules chains\n *   - getting main chain and named chains content (as arrays of functions)\n *\n * Helper methods, should not be used directly.\n * @api private\n */\n\nfunction Ruler() {\n  // List of added rules. Each element is:\n  //\n  // { name: XXX,\n  //   enabled: Boolean,\n  //   fn: Function(),\n  //   alt: [ name2, name3 ] }\n  //\n  this.__rules__ = [];\n\n  // Cached rule chains.\n  //\n  // First level - chain name, '' for default.\n  // Second level - digital anchor for fast filtering by charcodes.\n  //\n  this.__cache__ = null;\n}\n\n/**\n * Find the index of a rule by `name`.\n *\n * @param  {String} `name`\n * @return {Number} Index of the given `name`\n * @api private\n */\n\nRuler.prototype.__find__ = function (name) {\n  var len = this.__rules__.length;\n  var i = -1;\n\n  while (len--) {\n    if (this.__rules__[++i].name === name) {\n      return i;\n    }\n  }\n  return -1;\n};\n\n/**\n * Build the rules lookup cache\n *\n * @api private\n */\n\nRuler.prototype.__compile__ = function () {\n  var self = this;\n  var chains = [ '' ];\n\n  // collect unique names\n  self.__rules__.forEach(function (rule) {\n    if (!rule.enabled) {\n      return;\n    }\n\n    rule.alt.forEach(function (altName) {\n      if (chains.indexOf(altName) < 0) {\n        chains.push(altName);\n      }\n    });\n  });\n\n  self.__cache__ = {};\n\n  chains.forEach(function (chain) {\n    self.__cache__[chain] = [];\n    self.__rules__.forEach(function (rule) {\n      if (!rule.enabled) {\n        return;\n      }\n\n      if (chain && rule.alt.indexOf(chain) < 0) {\n        return;\n      }\n      self.__cache__[chain].push(rule.fn);\n    });\n  });\n};\n\n/**\n * Ruler public methods\n * ------------------------------------------------\n */\n\n/**\n * Replace rule function\n *\n * @param  {String} `name` Rule name\n * @param  {Function `fn`\n * @param  {Object} `options`\n * @api private\n */\n\nRuler.prototype.at = function (name, fn, options) {\n  var idx = this.__find__(name);\n  var opt = options || {};\n\n  if (idx === -1) {\n    throw new Error('Parser rule not found: ' + name);\n  }\n\n  this.__rules__[idx].fn = fn;\n  this.__rules__[idx].alt = opt.alt || [];\n  this.__cache__ = null;\n};\n\n/**\n * Add a rule to the chain before given the `ruleName`.\n *\n * @param  {String}   `beforeName`\n * @param  {String}   `ruleName`\n * @param  {Function} `fn`\n * @param  {Object}   `options`\n * @api private\n */\n\nRuler.prototype.before = function (beforeName, ruleName, fn, options) {\n  var idx = this.__find__(beforeName);\n  var opt = options || {};\n\n  if (idx === -1) {\n    throw new Error('Parser rule not found: ' + beforeName);\n  }\n\n  this.__rules__.splice(idx, 0, {\n    name: ruleName,\n    enabled: true,\n    fn: fn,\n    alt: opt.alt || []\n  });\n\n  this.__cache__ = null;\n};\n\n/**\n * Add a rule to the chain after the given `ruleName`.\n *\n * @param  {String}   `afterName`\n * @param  {String}   `ruleName`\n * @param  {Function} `fn`\n * @param  {Object}   `options`\n * @api private\n */\n\nRuler.prototype.after = function (afterName, ruleName, fn, options) {\n  var idx = this.__find__(afterName);\n  var opt = options || {};\n\n  if (idx === -1) {\n    throw new Error('Parser rule not found: ' + afterName);\n  }\n\n  this.__rules__.splice(idx + 1, 0, {\n    name: ruleName,\n    enabled: true,\n    fn: fn,\n    alt: opt.alt || []\n  });\n\n  this.__cache__ = null;\n};\n\n/**\n * Add a rule to the end of chain.\n *\n * @param  {String}   `ruleName`\n * @param  {Function} `fn`\n * @param  {Object}   `options`\n * @return {String}\n */\n\nRuler.prototype.push = function (ruleName, fn, options) {\n  var opt = options || {};\n\n  this.__rules__.push({\n    name: ruleName,\n    enabled: true,\n    fn: fn,\n    alt: opt.alt || []\n  });\n\n  this.__cache__ = null;\n};\n\n/**\n * Enable a rule or list of rules.\n *\n * @param  {String|Array} `list` Name or array of rule names to enable\n * @param  {Boolean} `strict` If `true`, all non listed rules will be disabled.\n * @api private\n */\n\nRuler.prototype.enable = function (list, strict) {\n  list = !Array.isArray(list)\n    ? [ list ]\n    : list;\n\n  // In strict mode disable all existing rules first\n  if (strict) {\n    this.__rules__.forEach(function (rule) {\n      rule.enabled = false;\n    });\n  }\n\n  // Search by name and enable\n  list.forEach(function (name) {\n    var idx = this.__find__(name);\n    if (idx < 0) {\n      throw new Error('Rules manager: invalid rule name ' + name);\n    }\n    this.__rules__[idx].enabled = true;\n  }, this);\n\n  this.__cache__ = null;\n};\n\n\n/**\n * Disable a rule or list of rules.\n *\n * @param  {String|Array} `list` Name or array of rule names to disable\n * @api private\n */\n\nRuler.prototype.disable = function (list) {\n  list = !Array.isArray(list)\n    ? [ list ]\n    : list;\n\n  // Search by name and disable\n  list.forEach(function (name) {\n    var idx = this.__find__(name);\n    if (idx < 0) {\n      throw new Error('Rules manager: invalid rule name ' + name);\n    }\n    this.__rules__[idx].enabled = false;\n  }, this);\n\n  this.__cache__ = null;\n};\n\n/**\n * Get a rules list as an array of functions.\n *\n * @param  {String} `chainName`\n * @return {Object}\n * @api private\n */\n\nRuler.prototype.getRules = function (chainName) {\n  if (this.__cache__ === null) {\n    this.__compile__();\n  }\n  return this.__cache__[chainName] || [];\n};\n\n/**\n * Expose `Ruler`\n */\n\nmodule.exports = Ruler;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}